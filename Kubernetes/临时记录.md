



## deployment的例子https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#creating-a-deployment
https://stackoverflow.com/questions/59480373/validationerror-missing-required-field-selector-in-io-k8s-api-v1-deployements
在kuvernetes version 1.16后取消apiVersion: extensions/v1beta1，这个版本
apiVersion: apps/v1

而且再apps/v1的版本中新增了selector字段，因此需要在spec中添加，missing required field "selector" in io.k8s.api.apps.v1.DeploymentSpec
```yaml
spec:
    selector:
      matchLabels:
        name: sawtooth-0
```


Add a service account to rbac.yaml

apiVersion: v1
kind: ServiceAccount
metadata:
  name: efs-provisioner

then updated the manifest.yaml deployment to contain the service account explicitly:

kind: Deployment
apiVersion: extensions/v1beta1
metadata:
  name: efs-provisioner
spec:
  replicas: 1
  strategy:
    type: Recreate 
  template:
    metadata:
      labels:
        app: efs-provisioner
    spec:
      serviceAccountName: efs-provisioner
https://github.com/kubernetes-incubator/external-storage/issues/953


## 部署metrics-server
git clone https://github.com/kubernetes-sigs/metrics-server.git
cd metrics-server/deploy/

## 需要修改kubernetes文件夹中的metrics-server-deployment.yaml。在容器metrics-server的args添加--kubelet-insecure-tls、--kubelet-preferred-address-types
kubectl apply -f /kubernetes


kubectl top nodes
kubectl top pod
kubectl get --raw "/apis/metrics.k8s.io/v1beta1/pods"
kubectl get --raw "/apis/metrics.k8s.io/v1beta1/nodes"
###参考信息
[从 Metric Server 到 Kubelet 服务证书](https://blog.fleeto.us/post/from-metric-server/)
[Kubernetes1.16集群中部署指标服务遇见的坑](https://www.sklinux.com/posts/k8s/%E9%9B%86%E7%BE%A4%E6%A0%B8%E5%BF%83%E6%8C%87%E6%A0%87%E6%9C%8D%E5%8A%A1/)